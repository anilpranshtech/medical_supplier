{% extends "pages/base.html" %}
{% load static %}

{% block content %}
<div class="kt-container-fixed mt-1" style="max-width: var(--custom-container-width, 85%);">
    <div class="flex flex-col items-stretch gap-7 mt-5 py-5">
        <main class="grow" role="content">
            <!-- Container -->
            <div class="kt-container-fixed">
                <div class="flex items-center justify-center flex-wrap lg:flex-nowrap gap-8 lg:gap-1.5 pt-5 mb-12">
                    <!-- Step Button -->
                    <div class="text-2sm leading-none relative flex items-center gap-1.5 px-3 h-8.5 rounded-full border font-medium border-primary/10 bg-primary/10 text-primary [&_.kt-step-icon]:text-primary">
                        <span class="kt-step-icon">
                            <i class="ki-filled ki-subtitle text-base"></i>
                        </span>
                        Order Summary
                    </div>
                    <div class="hidden lg:block w-12 h-px border-t border-dashed border-zinc-300 dark:border-zinc-600"></div>
                    <!-- Step Button -->
                    <div class="text-2sm leading-none relative flex items-center gap-1.5 px-3 h-8.5 rounded-full border border-border text-foreground [&_.kt-step-icon]:text-muted-foreground">
                        <span class="kt-step-icon">
                            <i class="ki-filled ki-delivery text-base"></i>
                        </span>
                        Shipping Info
                    </div>
                    <div class="hidden lg:block w-12 h-px border-t border-dashed border-zinc-300 dark:border-zinc-600"></div>
                    <!-- Step Button -->
                    <div class="text-2sm leading-none relative flex items-center gap-1.5 px-3 h-8.5 rounded-full border border-border text-foreground [&_.kt-step-icon]:text-muted-foreground">
                        <span class="kt-step-icon">
                            <i class="ki-filled ki-two-credit-cart text-base"></i>
                        </span>
                        Payment Method
                    </div>
                    <div class="hidden lg:block w-12 h-px border-t border-dashed border-zinc-300 dark:border-zinc-600"></div>
                    <!-- Step Button -->
                    <div class="text-2sm leading-none relative flex items-center gap-1.5 px-3 h-8.5 rounded-full border border-border text-foreground [&_.kt-step-icon]:text-muted-foreground">
                        <span class="kt-step-icon">
                            <i class="ki-filled ki-cheque text-base"></i>
                        </span>
                        Order Placed
                    </div>
                </div>
            </div>
            <!-- End of Container -->
            <!-- Container -->
            <div class="kt-container-fixed">
                <!-- begin: grid -->
                <div class="grid grid-cols-1 xl:grid-cols-3 gap-5 lg:gap-9 mb-5 lg:mb-10">
                    <div class="col-span-2 space-y-5">
                        <div class="grid sm:grid-cols-1 gap-5">
                            <div class="kt-card" data-product='{
                                "name": "Sterile Bandages",
                                "image": "{% static "metronic/tailwind/dist/assets/media/medical/600x600/bandages.png" %}",
                                "description": "High-quality sterile bandages for wound protection. Waterproof and breathable, ideal for minor cuts and abrasions.",
                                "sku": "MED-BND-001",
                                "category": "Wound Care",
                                "rating": 4.8,
                                "price": "$1.19",
                                "original_price": "",
                                "discount": "",
                                "more_info": "Pack of 50, latex-free, individually wrapped."
                            }'>
                                <div class="kt-card-content flex items-center flex-wrap justify-between gap-4.5 p-2 pe-5">
                                    <div class="flex items-center gap-3.5">
                                        <div class="kt-card flex items-center justify-center bg-accent/50 h-[70px] w-[90px] shadow-none">
                                            <img alt="Bandages" class="cursor-pointer h-[70px]"
                                                 data-kt-modal-toggle="#modal_shop_product_details"
                                                 src="{% static 'metronic/tailwind/dist/assets/media/medical/600x600/bandages.png' %}">
                                        </div>
                                        <div class="flex flex-col gap-1">
                                            <a class="hover:text-primary text-sm font-medium text-mono leading-5.5"
                                               data-kt-modal-toggle="#modal_shop_product_details" href="#">
                                                Sterile Bandages
                                            </a>
                                            <div class="flex items-center gap-1.5">
                                                <span class="text-xs font-normal text-secondary-foreground uppercase">
                                                    sku:
                                                    <span class="text-xs font-medium text-foreground">
                                                        MED-BND-001
                                                    </span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col gap-1.5">
                                        <span class="text-xs font-normal text-secondary-foreground text-end">
                                            1 x
                                        </span>
                                        <div class="flex items-center flex-wrap gap-1.5">
                                            <span class="text-sm font-semibold text-mono">
                                                $1.19
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="kt-card" data-product='{
                                "name": "Disposable Syringes (10-Pack)",
                                "image": "{% static "metronic/tailwind/dist/assets/media/medical/600x600/syringes.png" %}",
                                "description": "Sterile disposable syringes for precise medical administration. Suitable for clinical and home use.",
                                "sku": "MED-SYR-002",
                                "category": "Injection",
                                "rating": 3.5,
                                "price": "$0.60",
                                "original_price": "",
                                "discount": "",
                                "more_info": "10ml capacity, single-use, includes needles."
                            }'>
                                <div class="kt-card-content flex items-center flex-wrap justify-between gap-4.5 p-2 pe-5">
                                    <div class="flex items-center gap-3.5">
                                        <div class="kt-card flex items-center justify-center bg-accent/50 h-[70px] w-[90px] shadow-none">
                                            <img alt="Syringes" class="cursor-pointer h-[70px]"
                                                 data-kt-modal-toggle="#modal_shop_product_details"
                                                 src="{% static 'metronic/tailwind/dist/assets/media/medical/600x600/syringes.png' %}">
                                        </div>
                                        <div class="flex flex-col gap-1">
                                            <a class="hover:text-primary text-sm font-medium text-mono leading-5.5"
                                               data-kt-modal-toggle="#modal_shop_product_details" href="#">
                                                Disposable Syringes (10-Pack)
                                            </a>
                                            <div class="flex items-center gap-1.5">
                                                <span class="text-xs font-normal text-secondary-foreground uppercase">
                                                    sku:
                                                    <span class="text-xs font-medium text-foreground">
                                                        MED-SYR-002
                                                    </span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col gap-1.5">
                                        <span class="text-xs font-normal text-secondary-foreground text-end">
                                            1 x
                                        </span>
                                        <div class="flex items-center flex-wrap gap-1.5">
                                            <span class="text-sm font-semibold text-mono">
                                                $0.60
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="kt-card" data-product='{
                                "name": "Digital Thermometer",
                                "image": "{% static "metronic/tailwind/dist/assets/media/medical/600x600/thermometer.png" %}",
                                "description": "Fast and accurate digital thermometer for oral or underarm use. Easy-to-read display, suitable for all ages.",
                                "sku": "MED-THM-004",
                                "category": "Diagnostics",
                                "rating": 3.2,
                                "price": "$3.60",
                                "original_price": "$6.00",
                                "discount": "save 40%",
                                "more_info": "Water-resistant, includes battery and storage case."
                            }'>
                                <div class="kt-card-content flex items-center flex-wrap justify-between gap-4.5 p-2 pe-5">
                                    <div class="flex items-center gap-3.5">
                                        <div class="kt-card flex items-center justify-center bg-accent/50 h-[70px] w-[90px] shadow-none">
                                            <img alt="Thermometer" class="cursor-pointer h-[70px]"
                                                 data-kt-modal-toggle="#modal_shop_product_details"
                                                 src="{% static 'metronic/tailwind/dist/assets/media/medical/600x600/thermometer.png' %}">
                                        </div>
                                        <div class="flex flex-col gap-1">
                                            <a class="hover:text-primary text-sm font-medium text-mono leading-5.5"
                                               data-kt-modal-toggle="#modal_shop_product_details" href="#">
                                                Digital Thermometer
                                            </a>
                                            <div class="flex items-center gap-1.5">
                                                <span class="text-xs font-normal text-secondary-foreground uppercase">
                                                    sku:
                                                    <span class="text-xs font-medium text-foreground">
                                                        MED-THM-004
                                                    </span>
                                                </span>
                                                <span class="kt-badge kt-badge-destructive kt-badge-sm uppercase">
                                                    save 40%
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col gap-1.5">
                                        <span class="text-xs font-normal text-secondary-foreground text-end">
                                            1 x
                                        </span>
                                        <div class="flex items-center flex-wrap gap-1.5">
                                            <span class="text-sm font-normal text-secondary-foreground line-through">
                                                $6.00
                                            </span>
                                            <span class="text-sm font-semibold text-mono">
                                                $3.60
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="kt-card" data-product='{
                                "name": "Hand Sanitizer Gel",
                                "image": "{% static "metronic/tailwind/dist/assets/media/medical/600x600/sanitizer.png" %}",
                                "description": "Alcohol-based hand sanitizer gel for effective germ protection. Moisturizing formula, suitable for frequent use.",
                                "sku": "MED-SAN-007",
                                "category": "Hygiene",
                                "rating": 4.9,
                                "price": "$2.39",
                                "original_price": "$3.60",
                                "discount": "save 40%",
                                "more_info": "500ml bottle, 70% alcohol content."
                            }'>
                                <div class="kt-card-content flex items-center flex-wrap justify-between gap-4.5 p-2 pe-5">
                                    <div class="flex items-center gap-3.5">
                                        <div class="kt-card flex items-center justify-center bg-accent/50 h-[70px] w-[90px] shadow-none">
                                            <img alt="Sanitizer" class="cursor-pointer h-[70px]"
                                                 data-kt-modal-toggle="#modal_shop_product_details"
                                                 src="{% static 'metronic/tailwind/dist/assets/media/medical/600x600/sanitizer.png' %}">
                                        </div>
                                        <div class="flex flex-col gap-1">
                                            <a class="hover:text-primary text-sm font-medium text-mono leading-5.5"
                                               data-kt-modal-toggle="#modal_shop_product_details" href="#">
                                                Hand Sanitizer Gel
                                            </a>
                                            <div class="flex items-center gap-1.5">
                                                <span class="text-xs font-normal text-secondary-foreground uppercase">
                                                    sku:
                                                    <span class="text-xs font-medium text-foreground">
                                                        MED-SAN-007
                                                    </span>
                                                </span>
                                                <span class="kt-badge kt-badge-destructive kt-badge-sm uppercase">
                                                    save 40%
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col gap-1.5">
                                        <span class="text-xs font-normal text-secondary-foreground text-end">
                                            1 x
                                        </span>
                                        <div class="flex items-center flex-wrap gap-1.5">
                                            <span class="text-sm font-normal text-secondary-foreground line-through">
                                                $3.60
                                            </span>
                                            <span class="text-sm font-semibold text-mono">
                                                $2.39
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-end items-center flex-wrap gap-3">
                            <button class="kt-btn kt-btn-outline" fdprocessedid="1zln6">
                                Cancel
                            </button>
                            <a class="kt-btn kt-btn-primary"
                               href="{% url 'dashboard:shipping_info' %}">
                                Shipping Info
                                <i class="ki-filled ki-black-right text-base"></i>
                            </a>
                        </div>
                    </div>
                    <div class="col-span-1">
                        <div class="space-y-5">
                            <!-- begin: Card -->
                            <div class="kt-card bg-accent/50">
                                <div class="kt-card-header px-5">
                                    <h3 class="kt-card-title">
                                        Order Summary
                                    </h3>
                                </div>
                                <div class="kt-card-content px-5 py-4 space-y-2">
                                    <h4 class="text-sm font-medium text-mono mb-3.5">
                                        Price Details
                                    </h4>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-normal text-secondary-foreground">
                                            Subtotal
                                        </span>
                                        <span class="text-sm font-medium text-mono">
                                            $7.78
                                        </span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-normal text-secondary-foreground">
                                            Shipping
                                        </span>
                                        <span class="text-sm font-medium text-mono">
                                            $0.00
                                        </span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-normal text-secondary-foreground">
                                            VAT
                                        </span>
                                        <span class="text-sm font-medium text-mono">
                                            $0.00
                                        </span>
                                    </div>
                                </div>
                                <div class="kt-card-footer flex justify-between items-center px-5">
                                    <span class="text-sm font-normal text-secondary-foreground">
                                        Total
                                    </span>
                                    <span class="text-base font-semibold text-mono">
                                        $7.78
                                    </span>
                                </div>
                            </div>
                            <!-- end: Card -->
                        </div>
                    </div>
                </div>
                <!-- end: grid -->
            </div>
            <!-- End of Container -->
        </main>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const modalTriggers = document.querySelectorAll('[data-kt-modal-toggle="#modal_shop_product_details"]');
    const modal = document.querySelector('#modal_shop_product_details');
    const modalDismiss = modal.querySelector('[data-kt-modal-dismiss="true"]');

    modalTriggers.forEach(trigger => {
        trigger.addEventListener('click', function (e) {
            e.preventDefault();
            const card = trigger.closest('.kt-card');
            const productData = JSON.parse(card.dataset.product);

            // Populate modal with product data
            modal.querySelector('.product-image').src = productData.image;
            modal.querySelector('.product-name').textContent = productData.name;
            modal.querySelector('.product-description').textContent = productData.description;
            modal.querySelector('.product-sku').textContent = productData.sku;
            modal.querySelector('.product-category').textContent = productData.category;
            modal.querySelector('.product-price').textContent = productData.price;
            modal.querySelector('.product-more-info').textContent = productData.more_info;

            // Handle discount
            const discountElement = modal.querySelector('.product-discount');
            const originalPriceElement = modal.querySelector('.product-original-price');
            if (productData.discount) {
                discountElement.textContent = productData.discount;
                discountElement.classList.remove('hidden');
                originalPriceElement.textContent = productData.original_price;
                originalPriceElement.classList.add('hidden');
            } else {
                discountElement.classList.add('hidden');
                originalPriceElement.classList.add('hidden');
            }

            // Handle rating
            const ratingElement = modal.querySelector('.product-rating');
            ratingElement.innerHTML = ''; // Clear previous rating
            const rating = parseFloat(productData.rating);
            let ratingClass = 'kt-badge-danger';
            if (rating >= 4) {
                ratingClass = 'kt-badge-success';
            } else if (rating >= 2) {
                ratingClass = 'kt-badge-warning';
            }
            ratingElement.innerHTML = `
                <span class="kt-badge ${ratingClass} kt-badge-sm rounded-full gap-1">
                    <i class="ki-solid ki-star text-white -mt-0.5"></i> ${rating}
                </span>
            `;

            // Show modal
            modal.classList.remove('hidden');
        });
    });

    // Close modal
    modalDismiss.addEventListener('click', function () {
        modal.classList.add('hidden');
    });

    // Close modal when clicking outside
    modal.addEventListener('click', function (e) {
        if (e.target === modal) {
            modal.classList.add('hidden');
        }
    });
});
</script>

{% endblock content %}